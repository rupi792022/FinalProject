<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <title></title>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"
            integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4="
            crossorigin="anonymous">
    </script>
    <script src="../Scripts/ajaxCalls.js"></script>
    <script src="../Scripts/ajaxCallsWithKey.js"></script>
    <script>
        $(document).ready(function () {
            $("#Save").click(Save);
        });

        function Save() {
            getDatails = JSON.parse(localStorage.getItem('volunteerDetails'));

            let newpassword = $("#NewPassword").val();
            let verifynewpassword = $("#VerifyNewPassword").val();

            if (newpassword != verifynewpassword) {
                alert("Verification is not correct.")
            }
            else {

                if (newpassword != "")
                    password = $("#newpassword").val();
                else
                    password = getDatails.Volunteer_password;


                let firstname = $("#firstname").val();
                let lastname = $("#lastname").val();
                let birthdate = $("#birthdate").val();
                let mobilephone = $("#mobilephone").val();
                let email = getDatails.Volunteer_email;
                let gender = $("input[type=checkbox][name=gender]:checked").val();
                let startdate = $("#startdate").val();
                let volunteertype = $("input[type=checkbox][name=volunteertype]:checked").val();
                let language = $('#language').val();

                let MyVolunteerDetails = {
                    First_name: firstname,
                    Last_name: lastname,
                    Date_of_birth:birthdate,
                    Phone_number:mobilephone,
                    Gender: gender,
                    Volunteer_email: email,
                    Start_date: startdate,
                    Volunteer_type: volunteertype,
                    Volunteer_password: password,
                    Language:language
                }

                ajaxCall("PUT", "../api/Volunteers", JSON.stringify(MyVolunteerDetails), SaveSuccessCB, SaveErrorCB)
                return false;

                function SaveSuccessCB(data) {
                    console.log(data);
                    localStorage.setItem("volunteerDetails", JSON.stringify(MyVolunteerDetails));
                    window.location.href = "VolunteerHome.html";
                }
                function SaveErrorCB(error) {
                    console.log(error);
                }
            }
        }

    </script>
</head>
<body>
    <input type="text" id="firstname" name="fname" placeholder="Enter First Name" required><br><br>
    <input type="text" id="lastname" name="lname" placeholder="Enter Last Name" required><br><br>
    <input type="date" id="birthdate" name="birthdate" placeholder="Enter Birth Date" required><br><br>
    <input type="tel" id="mobilephone" name="mobilephone" placeholder="Enter Mobile Phone Number" pattern="[0][5][0-9]{1}[-]{0,1}[0-9]{3}[-]{0,1}[0-9]{4}"><br><br>

    <label>Gender:</label>
    <input type="checkbox" id="woman" name="gender" value="Woman">
    <label for="woman"> Woman</label>
    <input type="checkbox" id="man" name="gender" value="Man">
    <label for="man"> Man</label><br><br>

    <label>Volunteer Type:</label>
    <input type="checkbox" id="freetime" name="volunteertype" value="FreeTime">
    <label for="freetime"> Free Time</label>
    <input type="checkbox" id="againsthours" name="volunteertype" value="AgainstHours">
    <label for="againsthours"> Against hours</label><br><br>

    <label for="startdate">Start Date:</label>
    <input type="date" id="startdate" name="startdate" placeholder="Enter Start Date" required><br><br>

    <label for="language">Languages:</label>
    <select name="language" id="language">
        <option value="hebrew">Hebrew</option>
        <option value="english">English</option>
        <option value="russian">Russian</option>
        <option value="french">French</option>
        <option value="arabic">Arabic</option>
    </select>

    <label> Change password</label><br><br>
    <input type="password" id="NewPassword" name="NewPassword" placeholder="Enter New Password" pattern="[a-zA-Z0-9!@#$%^*_|]{8}"><br><br>
    <input type="password" id="VerifyNewPassword" name="VerifyNewPassword" placeholder="Enter Verify New Password" pattern="[a-zA-Z0-9!@#$%^*_|]{8}"><br><br>

    <button id="Save">Save</button>
</body>
</html>
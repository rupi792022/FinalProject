<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/css/bootstrap.min.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/js/bootstrap.min.js"></script>
    <script src="https://unpkg.com/sweetalert/dist/sweetalert.min.js"></script>
    <script src="../Scripts/ajaxCalls.js"></script>
    <title></title>
    <script>

        $(document).ready(function () {
            let apiCall = "../api/Twitters/getTweets";
            ajaxCall("GET", apiCall, "", getSuccessGetTweets, getErrorGetTweets);

            $(document).on("click", "#checkStatus", checkStatus);
        });

        function getSuccessGetTweets(tweets) {
            console.log("success GetTweets");
            Tweets = tweets;
            renderReport(tweets);
        }

        function renderReport(tweets) {
            str = "";
            for (var i = 0; i < tweets.length; i++) {
                str += "<p>" + tweets[i].LinkUrl + "</p>";
                str += "<p>" + tweets[i].Country + "</p>";
                str += "<p>" + tweets[i].Created_at + "</p>";
                str += "<p>" + tweets[i].Network + "</p>";
                str += "<p>" + tweets[i].Lang + "</p>";
                str += "<p>" + tweets[i].Volunteer_email + "</p>";
                str += "<p>" + tweets[i].Status + "</p>";
            }
                str += "<button id='checkStatus'>Check the status</button>";
                document.getElementById("reports").innerHTML = str;
        }

        function checkStatus() {
            let apiCall = "../api/Twitters/getStatusPage";
            ajaxCall("GET", apiCall, JSON.stringify(Tweets), getSuccessUrl, getErrorUrl);
        }

        function getErrorGetTweets(error) {
            console.log(error);
        }

        function getSuccessUrl(tweetStatus) {
            console.log("success tweetStatus");
            renderReport(tweetStatus);
        }

        function getErrorUrl(error) {
            console.log(error);
        }


    </script>
</head>
<body>
    <div id="reports"></div>
</body>
</html>